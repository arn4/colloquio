Here is a list of choice  I did  during implementation:
\begin{itemize}
  \item unique vector for w;
  \item training batch;
  \item pass ranges between classes 
\end{itemize}